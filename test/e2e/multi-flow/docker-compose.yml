services:
  # User's backend business logic - receives from both flows
  user-service:
    build:
      context: ./user-service
    ports:
      - "8082:8082"

  # Ingress â€” runs both flows concurrently (multi-flow support)
  fiso-flow:
    image: fiso-flow:e2e
    build:
      context: ../../..
      dockerfile: Dockerfile.flow
    ports:
      - "8080:8080"   # shared HTTP server (flow-a + flow-b via path routing)
    volumes:
      - ./fiso/flows:/etc/fiso/flows:ro
    environment:
      FISO_CONFIG_DIR: /etc/fiso/flows
      FISO_METRICS_ADDR: ":9090"
    depends_on:
      - user-service
